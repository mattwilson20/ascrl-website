<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News | ASCRL</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/page-flip@2.0.7/dist/js/page-flip.browser.min.js"></script>
    <style>
        /* News-Specific Enhancements */
        .magazine-rack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: -4rem; /* Overlap into Hero */
            position: relative;
            z-index: 10;
        }

        .featured-issue {
            grid-column: 1 / -1; /* Full width for the newest issue */
            display: flex;
            background: var(--card-bg);
            border: 1px solid var(--primary);
            overflow: hidden;
            box-shadow: 0 0 30px rgba(204, 0, 0, 0.2);
        }

        .issue-cover {
            width: 40%;
            object-fit: cover;
            border-right: 1px solid var(--border);
            transition: var(--transition);
        }

        .featured-issue:hover .issue-cover {
            transform: scale(1.05);
        }

        .issue-info {
            padding: 3rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* Reader Overlay Styling */
        #reader-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.98); z-index: 3000; display: none;
            flex-direction: column; align-items: center; justify-content: center;
            backdrop-filter: blur(15px);
        }

        .flipbook-container { 
            width: 90vw; height: 85vh; 
            max-width: 950px; display: flex; 
            justify-content: center; align-items: center; 
        }

        .page { background: white; box-shadow: 0 0 50px rgba(0,0,0,0.8); }
        .page img { width: 100%; height: 100%; object-fit: contain; }

        @media (max-width: 768px) {
            .featured-issue { flex-direction: column; }
            .issue-cover { width: 100%; height: 300px; }
            .magazine-rack { margin-top: 2rem; }
        }
    </style>
</head>
<body>

   <div class="hamburger" onclick="toggleMenu()">
        <div class="hamburger-line"></div>
        <div class="hamburger-line"></div>
        <div class="hamburger-line"></div>
    </div>

    <nav class="nav-overlay" id="nav-menu">
        <div class="nav-links">
            <a href="index.html">DASHBOARD</a>
            <a href="news.html">LATEST NEWS</a>
            <a href="standings.html">STANDINGS</a>
            <a href="results.html">RESULTS</a>
            <a href="schedule.html">CALENDAR</a>
            <a href="drivers.html" style="color:var(--primary)">ROSTER</a>
            <a href="rules.html">REGULATIONS</a>
        </div>
    </nav>


    <header class="hero">
        <p style="letter-spacing: 8px; color: var(--primary);">WEEKLY PRESS</p>
        <h1 class="text-gradient">ASCRL MAGAZINE</h1>
    </header>

    <main class="container">
        <div class="magazine-rack" id="magazine-grid">
            </div>
    </main>

    <div id="reader-overlay">
        <button class="btn-primary" style="position:fixed; top:2rem; right:2rem; z-index:3005; border:none; cursor:pointer;" onclick="closeReader()">CLOSE ISSUE</button>
        <div id="reader-loading" style="color:var(--primary); font-family:'Arial Black';">LOADING TELEMETRY...</div>
        <div class="flipbook-container" id="flipbook-root"></div>
    </div>

    <footer>© 2025-2026 AMERICAN STOCK CAR RACING LEAGUE</footer>

    <script>
        const articles = [
            {
                title: "VETERANS DAY TRIBUTE",
                date: "NOV 11, 2025",
                tag: "SPECIAL ISSUE",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/main/ASCRweeklyissue6.jpg",
                teaser: "A heartfelt tribute to our veterans ahead of the Las Vegas weekend, plus the official announcement of Backrow Motorsports.",
                pages: [
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/main/ASCRweeklyissue6.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/main/ASCRPage2.jpg"
                ]
            },
            {
                title: "NACHO SCORES NASHVILLE",
                date: "NOV 11, 2025",
                tag: "RACE RECAP",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/0a91dc765fb2ed87e57acdc2ec06585197ce0f30/ASCRweeklyissue5.jpg",
                teaser: "Eight races, eight different winners! Singular_Nacho becomes the latest first-time victor in an incredible display of parity.",
                pages: ["https://raw.githubusercontent.com/mattwilson20/ascrl-website/0a91dc765fb2ed87e57acdc2ec06585197ce0f30/ASCRweeklyissue5.jpg"]
            },
            {
                title: "HOMETOWN FAVORITE",
                date: "NOV 10, 2025",
                tag: "DRIVER SPOTLIGHT",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/7654906eeda55824349300cf0fe1b8cddf32f9c0/ASCRweeklyissue4.jpg",
                teaser: "The Tennessee native carries the hopes of the home crowd. Can Dewshine finally break through?",
                pages: ["https://raw.githubusercontent.com/mattwilson20/ascrl-website/7654906eeda55824349300cf0fe1b8cddf32f9c0/ASCRweeklyissue4.jpg"]
            }
        ];

        function toggleMenu() { document.getElementById('nav-menu').classList.toggle('open'); }

        function initNews() {
            const grid = document.getElementById('magazine-grid');
            grid.innerHTML = articles.map((art, i) => {
                if(i === 0) {
                    return `
                        <div class="featured-issue" onclick="openReader(${i})">
                            <img src="${art.preview}" class="issue-cover">
                            <div class="issue-info">
                                <span class="stat-label" style="color:var(--primary)">LATEST EDITION</span>
                                <h2 style="font-size:2.5rem; margin:1rem 0;">${art.title}</h2>
                                <p style="color:var(--text-muted); margin-bottom:2rem;">${art.teaser}</p>
                                <span class="btn-primary" style="width:fit-content">READ MAGAZINE</span>
                            </div>
                        </div>
                    `;
                }
                return `
                    <div class="race-card" onclick="openReader(${i})" style="cursor:pointer">
                        <span class="stat-label">${art.tag}</span>
                        <h3 style="margin:1rem 0;">${art.title}</h3>
                        <img src="${art.preview}" style="width:100%; border-radius:4px; margin-bottom:1rem;">
                        <span class="stat-label" style="color:var(--primary)">OPEN ISSUE →</span>
                    </div>
                `;
            }).join('');
        }

        let flipBook = null;

        function openReader(idx) {
            const overlay = document.getElementById('reader-overlay');
            const root = document.getElementById('flipbook-root');
            overlay.style.display = 'flex';
            document.body.style.overflow = 'hidden';

            root.innerHTML = `<div id="book-el">${articles[idx].pages.map(img => `<div class="page"><img src="${img}"></div>`).join('')}</div>`;

            setTimeout(() => {
                const el = document.getElementById('book-el');
                flipBook = new St.PageFlip(el, {
                    width: 500, height: 650,
                    size: "stretch", minWidth: 315, maxWidth: 950,
                    showCover: articles[idx].pages.length > 1,
                    drawShadow: true
                });
                flipBook.loadFromHTML(el.querySelectorAll('.page'));
                document.getElementById('reader-loading').style.display = 'none';
            }, 400);
        }

        function closeReader() {
            document.getElementById('reader-overlay').style.display = 'none';
            document.body.style.overflow = 'auto';
            if (flipBook) flipBook.destroy();
        }

        initNews();
    </script>
</body>
</html>
