<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News | ASCRL</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/page-flip@2.0.7/dist/js/page-flip.browser.min.js"></script>
    <style>
        :root {
            --primary: #c00;
            --accent: #ff0;
            --bg-dark: #000;
            --card-bg: #0d0d0d;
            --border: #1a1a1a;
            --text-muted: #a0a0a0;
            --transition: 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        body { margin: 0; font-family: 'Arial Black', sans-serif; background: var(--bg-dark); color: #fff; overflow-x: hidden; }

        /* --- MODULAR NAVIGATION STYLES --- */
        #nav-placeholder { position: relative; z-index: 2000; }
        
        .nav-overlay { 
            position: fixed; top: 0; left: -100%; width: 100%; max-width: 350px; 
            height: 100vh; background: #050505; transition: left 0.5s ease; 
            z-index: 1999; padding-top: 100px; border-right: 1px solid var(--primary); 
        }
        .nav-overlay.open { left: 0; }
        .nav-links { display: flex; flex-direction: column; padding: 0 3rem; }
        .nav-links a { 
            color: #fff; text-decoration: none; font-size: 1.2rem; padding: 1.2rem 0; 
            border-bottom: 1px solid var(--border); transition: var(--transition); letter-spacing: 2px; 
        }
        .nav-links a:hover { color: var(--primary); padding-left: 10px; }

        /* --- HERO --- */
        .hero { 
            background: radial-gradient(circle at center, #222 0%, #000 100%); 
            padding: 12rem 1rem 8rem; 
            text-align: center; 
            border-bottom: 1px solid var(--border);
        }
        h1 { font-size: clamp(3rem, 10vw, 5rem); margin: 0; letter-spacing: -2px; line-height: 0.9; }
        .hero p { color: var(--primary); letter-spacing: 5px; text-transform: uppercase; font-size: 0.9rem; margin-top: 1rem; }
        
        .text-gradient {
            background: linear-gradient(to bottom, #fff 30%, #444 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* --- MAGAZINE LAYOUT --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 4rem 2rem; }

        .magazine-rack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: -4rem; /* Overlap into Hero */
            position: relative;
            z-index: 10;
        }

        .featured-issue {
            grid-column: 1 / -1; /* Full width for the newest issue */
            display: flex;
            background: var(--card-bg);
            border: 1px solid var(--primary);
            overflow: hidden;
            box-shadow: 0 0 30px rgba(204, 0, 0, 0.2);
            cursor: pointer;
            transition: var(--transition);
        }
        .featured-issue:hover { transform: translateY(-5px); }

        .issue-cover {
            width: 40%;
            object-fit: cover;
            border-right: 1px solid var(--border);
            transition: var(--transition);
        }

        .featured-issue:hover .issue-cover { transform: scale(1.02); }

        .issue-info {
            padding: 3rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: left;
        }

        .race-card {
            background: var(--card-bg);
            padding: 2rem;
            border: 1px solid var(--border);
            transition: var(--transition);
            text-align: left;
        }
        .race-card:hover { border-color: var(--primary); transform: translateY(-5px); }

        .stat-label { font-size: 0.7rem; color: var(--text-muted); letter-spacing: 2px; text-transform: uppercase; display: block; margin-bottom: 0.5rem; }
        .btn-primary { background: var(--primary); color: #fff; padding: 10px 20px; text-decoration: none; border: none; font-family: 'Arial Black'; cursor: pointer; letter-spacing: 1px; }

        /* --- READER OVERLAY --- */
        #reader-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 3000; display: none;
            flex-direction: column; align-items: center; justify-content: center;
            backdrop-filter: blur(10px);
        }

        .flipbook-container { 
            width: 90vw; height: 85vh; 
            max-width: 950px; display: flex; 
            justify-content: center; align-items: center; 
        }

        .page { background: #fff; box-shadow: 0 0 50px rgba(0,0,0,0.8); }
        .page img { width: 100%; height: 100%; object-fit: contain; }

        footer { padding: 4rem 1rem; text-align: center; border-top: 1px solid var(--border); color: #333; font-size: 0.8rem; letter-spacing: 2px; }

        @media (max-width: 768px) {
            .featured-issue { flex-direction: column; }
            .issue-cover { width: 100%; height: 300px; }
            .magazine-rack { margin-top: 2rem; }
            .issue-info { padding: 2rem; }
        }
    </style>
</head>
<body>

    <div id="nav-placeholder"></div>

    <header class="hero">
        <p>WEEKLY PRESS</p>
        <h1 class="text-gradient">ASCRL MAGAZINE</h1>
    </header>

    <main class="container">
        <div class="magazine-rack" id="magazine-grid"></div>
    </main>

    <div id="reader-overlay">
        <button class="btn-primary" style="position:fixed; top:2rem; right:2rem; z-index:3005;" onclick="closeReader()">CLOSE ISSUE ✕</button>
        <div id="reader-loading" style="color:var(--primary); font-family:'Arial Black'; margin-bottom: 1rem;">LOADING TELEMETRY...</div>
        <div class="flipbook-container" id="flipbook-root"></div>
    </div>

    <footer>© 2025-2026 AMERICAN STOCK CAR RACING LEAGUE</footer>

    <script>
        // --- 1. MODULAR NAVIGATION ---
        fetch('nav.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('nav-placeholder').innerHTML = data;
                
                const currentPage = window.location.pathname.split("/").pop() || "index.html";
                const navID = "nav-" + currentPage.split(".")[0];
                const activeLink = document.getElementById(navID);
                if (activeLink) {
                    activeLink.style.color = "var(--primary)";
                    activeLink.style.borderLeft = "4px solid var(--primary)";
                    activeLink.style.paddingLeft = "15px";
                }
            });

        function toggleMenu() { 
            const menu = document.getElementById('nav-menu');
            if (menu) menu.classList.toggle('open'); 
        }

       // --- 2. ARTICLE DATABASE ---
        const articles = [
            {
                title: "WEEKLY RECAP: DEGA NEXT",
                date: "DEC 12, 2025",
                tag: "WEEKLY UPDATE",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/5beac92cd866f7c6baa5bd0558c7b8691ac5e647/ASCRWeekly16.jpg",
                teaser: "Exciting week of racing! Incidents, dominant wins, and a huge fuel save gamble paying off. Next up? DEGA BABY.",
                pages: [
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/5beac92cd866f7c6baa5bd0558c7b8691ac5e647/ASCRWeekly16.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/66be6b3356b3d70ae55d6fc5075205fb73bd0a9f/PAGE2hh.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/a72a9a3290424ea197e4fd4aa2cfd734e6eccbdf/DriverspotlightH.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/f0e7422c6e5f77f2c3a1d345283a7a8b8978578f/Page4h.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/552e9bba1349ccd1b739e34048811be0978e7c14/PAGE3H.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/f2ab50437c9f2f3cc8acaeb018168e651d31bcbc/Page5.jpg",
                    "<b>WEEKLY RECAP</b><br><br>Exciting week of racing! We saw an on-track incident between Dakota and Steve, a dominant performance by Hockey, and two DNFs for Blaze.<br><br>A fuel save strategy paid off big for Matt and got the Barbasol Bandit his first career top 5!<br><br>Next up? DEGA BABY.<br><br>Congrats to this week's winners: HockeyDeckout, Singular_Nacho, mattwilson20, and ALESSI-20-11."
                ]
            },
            {
                title: "SPOTLIGHT: SINGULAR_NACHO",
                date: "DEC 06, 2025",
                tag: "DRIVER SPOTLIGHT",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/d58bd391c0918995d0cd0907ab3178e273ef0978/DriverspotlightNacho.jpg",
                teaser: "Singular_Nacho gets this week's Driver Spotlight! Fast in any car and loved by his Backrow Motorsports team.",
                pages: [
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/d58bd391c0918995d0cd0907ab3178e273ef0978/DriverspotlightNacho.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/e99cd4a205ab127ddae7386ade89613389aa1d61/NACHO.jpg",
                    "<b>DRIVER SPOTLIGHT: SINGULAR_NACHO</b><br><br>Singular_Nacho gets this week's Driver Spotlight.<br><br>He is fast in any car you put him in and is very loved by his Backrow Motorsports team!"
                ]
            },
            {
                title: "WINNERS & NEW TIERS",
                date: "DEC 05, 2025",
                tag: "WEEKLY UPDATE",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/60350115c6f8cb9034b367e4fd3211c02237b38f/ASCRWeekly15.jpg",
                teaser: "Shoutout to winners HockeyDeckout, Duramax18gg, and ALESSI-20-11! Best week of racing yet plus the new Tier System introduction.",
                pages: [
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/60350115c6f8cb9034b367e4fd3211c02237b38f/ASCRWeekly15.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/22b2fe5149285cb1334b2f0f0b1f97e559943ee5/PAGE2.jpg",
                    "<b>WEEKLY RECAP</b><br><br>Shoutout to our Winners this week: HockeyDeckout, Duramax18gg, and ALESSI-20-11.<br><br>This by far was our best week of racing yet as we had multiple races go green, minimal wrecks! It also saw the introduction of the new Tier System.<br><br><b>NOTE FROM EDITOR:</b><br>Notice there is No Driver Spotlight yet, I'm working on getting it finished. Going forward, rather than a bunch of cover photos, the newsletter will release once a week (between Friday-Saturday). In a perfect world, it will highlight the past week, look forward to the new week, and spotlight one standout driver.<br><br>Please be patient as I continue to format and improve the newsletter. Hope y'all like it!"
                ]
            },
            {
                title: "SPOTLIGHT: BARBASOL BANDIT",
                date: "NOV 29, 2025",
                tag: "DRIVER SPOTLIGHT",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/5330a2da8d5224dc4c59be007b2a2d207af2f9ea/ASCRIssue14.jpg",
                teaser: "This week's Driver Spotlight goes to... myself, the one and only Barbasol Bandit! Plus, big quality updates for the magazine.",
                pages: [
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/5330a2da8d5224dc4c59be007b2a2d207af2f9ea/ASCRIssue14.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/a6c4212c570f649830e570786f730af38e8af518/ASCR2.jpg",
                    "<b>SPOTLIGHT: BARBASOL BANDIT</b><br><br>This week's Driver Spotlight goes to... myself, the one and only Barbasol Bandit!<br><br>I’m not that egotistical; I just did some editing to things about the newsletter you guys will never notice but bother my eyes. Everything is perfectly centered now, and the images have a crisp 300PPI, which means if I ever print these they’ll come out the same dimensions and quality as any other standardized magazine!"
                ]
            },
            {
                title: "SPOTLIGHT: ORANGEMAN96",
                date: "NOV 22, 2025",
                tag: "DRIVER SPOTLIGHT",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/1dff22449977402ecd931db827dbf75a832609ec/ASCRWeeklyIssue13.jpg",
                teaser: "Driver Spotlight is on Orangeman96 this time! Who should be next?",
                pages: [
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/1dff22449977402ecd931db827dbf75a832609ec/ASCRWeeklyIssue13.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/b6f29805287e944a30e75a8224e022a9b785de42/orange.jpg",
                    "<b>DRIVER SPOTLIGHT: ORANGEMAN96</b><br><br>Driver Spotlight is on Orangeman96 this time!<br><br>Who should be next?"
                ]
            },
            {
                title: "NEWSLETTER NOW IN HD",
                date: "NOV 22, 2025",
                tag: "LEAGUE UPDATE",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/8e00327b77d49a459a7fe0a696e39b03dd9aaac1/ASCRWeeklyIssue12.jpg",
                teaser: "The ASCR Newsletter is now in HD! Plus, the league takes a firm stance on griefers after a wild week.",
                pages: [
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/8e00327b77d49a459a7fe0a696e39b03dd9aaac1/ASCRWeeklyIssue12.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/1f2873e436d3798ee2c0dd1511b13a22080173d5/ASCRPage2-2.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/b988df277de0c687deec9222bffe6298752fa2bd/ASCRPage3.jpg",
                    "<b>ASCR NEWSLETTER IS NOW IN HD!</b><br><br>Wild week for the league. Drivers were tormented by Lil Xan, Cloth Napkin, and ProsPoint Gaming.<br><br>League owner Matt Wilson promises to keep a firm stance on griefers while giving a fair shot to anyone who is honestly working towards getting better. His stance is and always will be: “Clean Is Better Than Fast!”"
                ]
            },
            {
                title: "TENSIONS FLY AT BRISTOL",
                date: "NOV 19, 2025",
                tag: "RACE RECAP",
                preview: "https://github.com/mattwilson20/ascrl-website/blob/main/ASCRISSUE11.jpg?raw=true",
                teaser: "A controversial end to a controversial race! HockeyDeckout puts fan favorite DakotaThomas1994 into the wall for the win.",
                pages: [
                    "https://github.com/mattwilson20/ascrl-website/blob/main/ASCRISSUE11.jpg?raw=true",
                    "<b>TENSIONS FLY AT BRISTOL</b><br><br>A controversial end to a controversial race. Dominant driver HockeyDeckout puts fan favorite dakotathomas1994 into the wall in turn 4 of the white flag lap for the win.<br><br>Tensions were hot after the race, with Deckout claiming wall bang for Dakota. Both drivers have a case, and opinions are split on who was wrong.<br><br>Will things heat up next week at The Glen, or was this just good hard racing? We will find out on Tuesday."
                ]
            },
            {
                title: "SPOTLIGHT: HATTERMAD218",
                date: "NOV 16, 2025",
                tag: "DRIVER SPOTLIGHT",
                preview: "https://github.com/mattwilson20/ascrl-website/blob/main/ASCRissue10.jpg?raw=true",
                teaser: "The very first Driver Spotlight issue goes to HatterMAD218! From dirt roots to a Toyota seat.",
                pages: [
                    "https://github.com/mattwilson20/ascrl-website/blob/main/ASCRissue10.jpg?raw=true",
                    "<b>DRIVER SPOTLIGHT: HATTERMAD218</b><br><br>The very first Driver Spotlight issue goes to HatterMAD218.<br><br>He has roots in dirt and GT racing, but he recently came to ASCR, signing with Gazoo Motorsports to run the #73 Toyota for them in the 2026 season."
                ]
            },
            {
                title: "RHINO LEAVES APEX",
                date: "NOV 15, 2025",
                tag: "BREAKING NEWS",
                preview: "https://github.com/mattwilson20/ascrl-website/blob/main/ASCRissue9.jpg?raw=true",
                teaser: "Sources confirm that TheReaperRhino has parted ways with Apex Racing. Tensions boiled over after the Las Vegas race.",
                pages: [
                    "https://github.com/mattwilson20/ascrl-website/blob/main/ASCRissue9.jpg?raw=true",
                    "Sources confirm that TheReaperRhino has parted ways with Apex Racing.<br><br>Rhino expressed anger at teammate dakotathomas1994, which boiled over after the Las Vegas race in the garage. He accuses Apex of prioritizing drivers like Dakota and MajorBlaz33 over him, giving them better equipment.<br><br>With his departure, Dakota moves over to the 24 car and vows to win at Bristol just to prove him wrong. Sources still unsure why the hell Rhino started a Ford Team."
                ]
            },
            {
                title: "TEAMS EDITION",
                date: "NOV 13, 2025",
                tag: "ASCR WEEKLY #8",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/52a4a9654a523f74d2cc913c553e678a7fa387c7/ASCRweeklyissue8.jpg",
                teaser: "A fun and lighthearted look at the teams! Thanks to everyone who reached out with context to fill these pages.",
                pages: [
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/52a4a9654a523f74d2cc913c553e678a7fa387c7/ASCRweeklyissue8.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/738345e5637e178e82ca96f516d783f01fb0268d/ASCRPage2.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/fbfa579723c77e6fbf3d60eb03885f5e66f0d1d9/ascrp3.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/7052e9039271786c89076e3ec430c84f27f20c11/ascrp4.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/52f9a743956628f894ed18cc68a7e1f7198311ca/ascrp5.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/b9af07f0f081c9ee4802009f20ed588339aa9b98/ascrp6.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/5097bc72fc757138a902981f441cf90e9882abe7/ascrp7.jpg"
                ]
            },
            {
                title: "HOCKEY DOMINATES VEGAS",
                date: "NOV 12, 2025",
                tag: "ASCR WEEKLY #7",
                preview: "https://github.com/mattwilson20/ascrl-website/blob/main/ASCRweeklyissue7.jpg?raw=true",
                teaser: "HockeyDeckout would NOT be denied at Vegas! Tons of green flag racing made this the most exciting race of the year.",
                pages: [
                    "https://github.com/mattwilson20/ascrl-website/blob/main/ASCRweeklyissue7.jpg?raw=true",
                    "HockeyDeckout would NOT be denied at Vegas!<br><br>With tons of green flag racing, Vegas stood out as the most exciting race of the year for ASCR.<br><br>Top drivers fought to stay on the lead lap, and others drove hard to get back to the front. In the end, it was an absolute clinic put on by Hockey."
                ]
            },
            {
                title: "VETERANS DAY TRIBUTE",
                date: "NOV 11, 2025",
                tag: "SPECIAL ISSUE",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/main/ASCRweeklyissue6.jpg",
                teaser: "A heartfelt tribute to our veterans ahead of the Las Vegas weekend, plus the official announcement of Backrow Motorsports.",
                pages: [
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/main/ASCRweeklyissue6.jpg",
                    "https://raw.githubusercontent.com/mattwilson20/ascrl-website/main/ASCRPage2.jpg"
                ]
            },
            {
                title: "NACHO SCORES NASHVILLE",
                date: "NOV 11, 2025",
                tag: "RACE RECAP",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/0a91dc765fb2ed87e57acdc2ec06585197ce0f30/ASCRweeklyissue5.jpg",
                teaser: "Eight races, eight different winners! Singular_Nacho becomes the latest first-time victor in an incredible display of parity.",
                pages: ["https://raw.githubusercontent.com/mattwilson20/ascrl-website/0a91dc765fb2ed87e57acdc2ec06585197ce0f30/ASCRweeklyissue5.jpg"]
            },
            {
                title: "HOMETOWN FAVORITE",
                date: "NOV 10, 2025",
                tag: "DRIVER SPOTLIGHT",
                preview: "https://raw.githubusercontent.com/mattwilson20/ascrl-website/7654906eeda55824349300cf0fe1b8cddf32f9c0/ASCRweeklyissue4.jpg",
                teaser: "The Tennessee native carries the hopes of the home crowd. Can Dewshine finally break through?",
                pages: ["https://raw.githubusercontent.com/mattwilson20/ascrl-website/7654906eeda55824349300cf0fe1b8cddf32f9c0/ASCRweeklyissue4.jpg"]
            },
            {
                title: "KEVWOOD WINS ARCA OPENER",
                date: "NOV 09, 2025",
                tag: "ASCR WEEKLY #3",
                preview: "https://github.com/mattwilson20/ascrl-website/blob/main/ASCRweeklyissue3.jpg?raw=true",
                teaser: "kevwood87 made his first career start with ASCR and showed the league he is a force to be reckoned with.",
                pages: [
                    "https://github.com/mattwilson20/ascrl-website/blob/main/ASCRweeklyissue3.jpg?raw=true",
                    "kevwood87 made his first career start with ASCR and showed the league he is a force to be reckoned with.<br><br>The ARCA opener saw some dirt guys come over for a little asphalt racing.<br><br>Congrats Kev on the win and being on the cover of this issue of the newsletter!"
                ]
            },
            {
                title: "PRESEASON OPENER",
                date: "NOV 09, 2025",
                tag: "RACE PREVIEW",
                preview: "https://github.com/mattwilson20/ascrl-website/blob/main/ASCRweeklyissue2.jpg?raw=true",
                teaser: "Looking to be a small field at Phoenix for the preseason opener, but the competition will be fierce.",
                pages: [
                    "https://github.com/mattwilson20/ascrl-website/blob/main/ASCRweeklyissue2.jpg?raw=true"
                ]
            },
            {
                title: "ASCR WEEKLY ISSUE #1",
                date: "NOV 07, 2025",
                tag: "COVER STORY",
                preview: "https://github.com/mattwilson20/ascrl-website/blob/main/big-fella-atlanta-win.jpg?raw=true",
                teaser: "BIG_FELLAx2220 takes the win at Atlanta! A special look at the very first cover of ASCR Weekly.",
                pages: [
                    "https://github.com/mattwilson20/ascrl-website/blob/main/big-fella-atlanta-win.jpg?raw=true",
                    "BIG_FELLAx2220, I didn’t feel right giving you a half-assed magazine cover after a win like that.<br><br>I needed some practice so I can really nail down the format/style of the newsletter.<br><br>Congrats on being the cover of ASCR Weekly Issue #1!"
                ]
            }
        ];

        // --- 3. RENDER LOGIC ---
        function initNews() {
            const grid = document.getElementById('magazine-grid');
            grid.innerHTML = articles.map((art, i) => {
                // First item is the Featured Banner
                if(i === 0) {
                    return `
                        <div class="featured-issue" onclick="openReader(${i})">
                            <img src="${art.preview}" class="issue-cover">
                            <div class="issue-info">
                                <span class="stat-label" style="color:var(--primary)">LATEST EDITION // ${art.date}</span>
                                <h2 style="font-size:2.5rem; margin:1rem 0; line-height:1;">${art.title}</h2>
                                <p style="color:var(--text-muted); margin-bottom:2rem; font-family:sans-serif; line-height:1.5;">${art.teaser}</p>
                                <span class="btn-primary" style="width:fit-content">READ MAGAZINE</span>
                            </div>
                        </div>
                    `;
                }
                // Other items are grid cards
                return `
                    <div class="race-card" onclick="openReader(${i})" style="cursor:pointer">
                        <span class="stat-label">${art.tag}</span>
                        <h3 style="margin:1rem 0; font-size:1.2rem;">${art.title}</h3>
                        <img src="${art.preview}" style="width:100%; border-radius:4px; margin-bottom:1rem; border:1px solid #333;">
                        <span class="stat-label" style="color:var(--primary); cursor:pointer;">OPEN ISSUE →</span>
                    </div>
                `;
            }).join('');
        }

        // --- 4. FLIPBOOK LOGIC ---
        let flipBook = null;

        function openReader(idx) {
            const overlay = document.getElementById('reader-overlay');
            const root = document.getElementById('flipbook-root');
            
            overlay.style.display = 'flex';
            document.body.style.overflow = 'hidden'; // Stop background scrolling

            // Setup HTML structure for pages
            root.innerHTML = `<div id="book-el">
                ${articles[idx].pages.map(content => {
                    // 1. CHECK FOR IMAGE (Links ending in jpg, png, etc, or containing 'blob')
                    if (content.startsWith('http')) {
                        return `<div class="page"><img src="${content}"></div>`;
                    } 
                    // 2. TEXT CONTENT (Force Black Color)
                    else {
                        return `<div class="page" style="padding:40px; background:#fff; color:#000;">
                                    <div style="height:100%; display:flex; align-items:center; justify-content:center; text-align:left;">
                                        <p style="font-family:Arial, sans-serif; font-size:1.1rem; line-height:1.6; color:#000 !important; margin:0;">
                                            ${content}
                                        </p>
                                    </div>
                                </div>`;
                    }
                }).join('')}
            </div>`;

            // Initialize PageFlip Library
            setTimeout(() => {
                const el = document.getElementById('book-el');
                flipBook = new St.PageFlip(el, {
                    width: 500, height: 650,
                    size: "stretch", minWidth: 315, maxWidth: 950,
                    showCover: articles[idx].pages.length > 1, 
                    drawShadow: true
                });
                
                flipBook.loadFromHTML(el.querySelectorAll('.page'));
                document.getElementById('reader-loading').style.display = 'none';
            }, 300);
        }

        function closeReader() {
            document.getElementById('reader-overlay').style.display = 'none';
            document.body.style.overflow = 'auto'; // Restore scrolling
            if (flipBook) flipBook.destroy();
            document.getElementById('reader-loading').style.display = 'block';
        }

        initNews();
    </script>
</body>
</html>
